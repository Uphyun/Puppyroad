<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.puppyroad.app.petstarbulletin.mapper.PetstarCommentMapper">
	<!-- 전체조회 -->
	<select id="selectCommentList" resultType="PetstarCommentVO">
		SELECT   comment_code
				,writer
				,content
				,create_date
				,update_date
				,bulletin_no
		FROM  pet_stargram_comment 
		ORDER BY writing_date DESC
	</select>
	<!-- 단건조회 -->
	<select id="selectCommentInfo" resultType="PetstarCommentVO">
		SELECT   comment_code
				,writer
				,content
				,create_date
				,update_date
				,bulletin_no
		FROM  pet_stargram_comment
		WHERE bulletin_no = #{bulletinNo}
	</select>
	<!-- 등록 -->
	<insert id="insertComment" parameterType="PetstarCommentVO">
		<selectKey keyProperty="commentCode"
				   resultType="String"
				   order="BEFORE">
			   SELECT NVL(MAX(comment_code), 0 ) + 1
			   FROM   pet_stargram_comment
		</selectKey>	
		INSERT INTO pet_stargram_comment
			(
				 comment_code
				,writer
				,content
				,create_date
		   )
		 VALUES
		   (
		   		 #{commentCode}
		   		,#{writer}
		   		,#{content}
		   		,NVL(#{createDate}, sysdate)
		   	)  
	</insert>
	
	<!-- 수정 -->
	<update id="updateComment" parameterType="PetstarCommentVO">
		UPDATE pet_stargram_comment
		 SET
		    content = #{content}
		   ,update_date = sysdate
		WHERE bulletin_no = #{bulletinNo}
	</update>
	
	<!-- 삭제 -->
	<delete id="deleteComment" parameterType="int">
		DELETE FROM pet_stargram_comment
		WHERE  comment_code = #{commentCode}
	</delete>
</mapper>